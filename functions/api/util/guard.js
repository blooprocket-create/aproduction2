const {verify}=require('./jwt');function getAuth(e){const h=e.headers?.authorization||e.headers?.Authorization||'';const m=h.match(/^Bearer\s+(.+)$/);if(!m) return null;return verify(m[1])}function requireRole(d,r=[]){if(!d) return false;if(!r||r.length===0) return !!d;return r.includes(d.role)}module.exports={getAuth,requireRole};